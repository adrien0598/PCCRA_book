[["cpt.html", "Chapter 4 Réponse à la Camptothecine 4.1 Réponse des mutants à CPT 4.2 GO enrichissement 4.3 Nouvelle approche (pénalisée) 4.4 Encore une autre approche", " Chapter 4 Réponse à la Camptothecine library(tidyr) library(stringr) library(FactoMineR) library(ggplot2) 4.1 Réponse des mutants à CPT cpt = data.frame(ORF = d_merge$ORF, Reponse_cpt = d_merge$camptothecin_500um) ggplot(cpt) + aes(x = Reponse_cpt) + theme_classic()+ geom_histogram(aes(y = after_stat(density)), color = &quot;grey&quot;, fill = &quot;lightblue&quot;) + geom_density(color = &quot;grey&quot;, fill = &quot;#F85700&quot;, alpha = 0.3) cpt$ORF[cpt$Reponse_cpt &gt; 2.5] %&gt;% length() ## [1] 4 cpt$ORF[cpt$Reponse_cpt &gt; 2] %&gt;% length() ## [1] 8 cpt$ORF[cpt$Reponse_cpt &gt; 1.5] %&gt;% length() ## [1] 43 cpt$ORF[cpt$Reponse_cpt &lt; -1] %&gt;% length() ## [1] 3 cpt$ORF[cpt$Reponse_cpt &lt; -.8] %&gt;% length() ## [1] 6 cpt$ORF[cpt$Reponse_cpt &lt; -.7] %&gt;% length() ## [1] 13 cpt$ORF[cpt$Reponse_cpt &lt; -.6] %&gt;% length() ## [1] 24 cpt$ORF[cpt$Reponse_cpt &lt; -.5] %&gt;% length() ## [1] 61 4.2 GO enrichissement En utilisant https://yeastgenome.org/goTermFinder, on regarde si le groupe des gènes dont la mutation entraine une plus grande sensibilité à cpt est enrichis par rapport au génome ebntier dans certaines fonctions moléculaire, localisations cellulaires ou processus biologiques : 4.2.1 Mutants les plus resistants à CPT # les 43 plus resistant à cpt write.table(data.frame(ORF = d_merge$Gene, Reponse_cpt = d_merge$camptothecin_500um)$ORF[cpt$Reponse_cpt &gt; 1.5], file = &quot;data/gene_15.txt&quot;, row.names = FALSE, quote = FALSE) rien de ouf, marche pas trop 4.2.2 Les 24 plus sensibles # les 24 plus senssible à cpt write.table(data.frame(ORF = d_merge$Gene, Reponse_cpt = d_merge$camptothecin_500um)$ORF[cpt$Reponse_cpt &lt; -.6], file = &quot;data/gene_-6.txt&quot;, row.names = FALSE, quote = FALSE) tmp = read.table(&quot;data/go/24_process.txt&quot;, sep = &quot;\\t&quot;, header = TRUE) tmp = data.frame(Term = tmp$TERM, p_value = tmp$CORRECTED_PVALUE, FDR = tmp$FDR_RATE, Gene = tmp$ANNOTATED_GENES) knitr::kable(tmp, caption = &quot;Biological Process&quot;) Table 4.1: Biological Process Term p_value FDR Gene ribonucleoprotein complex biogenesis 0.0020432 2.00% RPL30, SMD2, TRM112, RVB2, RPL16B, SKI6, RPB8, PRP11, RPS1A, RPL6B RNA processing 0.0066931 1.00% RPL16B, PRP11, SKI6, RPL30, SMD2, TRM112, RVB2, RPS1A, MOD5, SPT6 tmp = read.table(&quot;data/go/24_function.txt&quot;, sep = &quot;\\t&quot;, header = TRUE) tmp = data.frame(Term = tmp$TERM, p_value = tmp$CORRECTED_PVALUE, FDR = tmp$FDR_RATE, Gene = tmp$ANNOTATED_GENES) knitr::kable(tmp, caption = &quot;Molecular Function&quot;) Table 4.1: Molecular Function Term p_value FDR Gene structural constituent of ribosome 0.0042054 4.00% RPL16B, RPL43A, RPL30, RPS1A, RPL6B, MRPL20 binding 0.0050341 3.00% RPL6B, MOD5, BUB1, RVB2, VAM3, RPL43A, RPL30, RPB8, ARO9, PRP11, SKI6, IFM1, CCT4, TRM112, HSM3, DFM1, SPT6, PDC6, CDC25, SMD2, RPL16B tmp = read.table(&quot;data/go/24_component.txt&quot;, sep = &quot;\\t&quot;, header = TRUE) tmp = data.frame(Term = tmp$TERM, p_value = tmp$CORRECTED_PVALUE, FDR = tmp$FDR_RATE, Gene = tmp$ANNOTATED_GENES) knitr::kable(tmp, caption = &quot;Cellular Component&quot;) Table 4.1: Cellular Component Term p_value FDR Gene large ribosomal subunit 0.0060034 0.00% RPL43A, RPL30, RPL16B, RPL6B, MRPL20 cytosolic part 0.0062126 0.00% RPL30, RPL43A, RPL16B, RPL6B, CCT4, RPS1A macromolecular complex 0.0063399 0.00% RPL43A, RPL16B, RPB8, RPL6B, DFM1, VAM3, TRM112, RVB2, RPL30, BUB1, PRP11, SPT6, MRPL20, CCT4, RPS1A, SKI6, SMD2 ribosomal subunit 0.0074783 0.00% RPL30, RPS1A, RPL6B, RPL16B, RPL43A, MRPL20 les mutant “les plus senssible” à cpt sont en réalité des mutants qui ont des fitness defect significatif dans pratiquement toutes les conditions. Ces mutant sont probablement les plus senssible à tout type de stress/drogue car leurs mutations sont graves. Exemple de RPL30 : RPL30 = d_merge[d_merge$Gene == &quot;RPL30&quot;,][-c(1,2)] %&gt;% unlist() ggplot(data.frame(Fitness_d = RPL30)) + aes(x = Fitness_d)+ geom_density()+ geom_vline(xintercept = 0, color = &quot;black&quot;) + # 0 geom_vline(xintercept = RPL30 %&gt;% mean(), color = &quot;blue&quot;, linetype = &quot;dashed&quot;) + #moyenne geom_vline(xintercept = d_merge[d_merge$Gene == &quot;RPL30&quot;,]$camptothecin_500um, color = &quot;green&quot;) + #CPT response theme_classic() 4.3 Nouvelle approche (pénalisée) Pour être considéré comme sensible à CPT, un gène doit être plus senssible à CPT qu’aux autres stress : gene = d_merge[d_merge$camptothecin_500um &lt; 0,]$Gene cpt_d_merge = d_merge[d_merge$camptothecin_500um &lt; 0,][-c(1,2)] cpt_d_merge %&gt;% dim() ## [1] 1848 448 # correction par rapport à la médianne tmp_med = cpt_d_merge %&gt;% apply(1, function(x){ x - median(x) }) %&gt;% as.data.frame() %&gt;% t() %&gt;% as.data.frame() tmp_med$camptothecin_500um %&gt;% summary() ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## -1.54474 -0.26967 -0.17085 -0.19652 -0.09517 0.31935 Marche pas du tout à cause du bazard négatif positif etc. Pas le temps de ce pencher dessus pour de vrai. Autre approche : prendre pour chaque mutant les 5% stress qui le mette le plus en pls. On part en fait de l’hypothèse que comme CPT est très toxique (introduction), elle est parmis les drogues les plus efficace pour eliminer les souches mutantes dans des voies liées à son mode d’action. # les plus sensible classement = NULL nb = 25 cutoff = -0.4 for (i in c(1:(gene %&gt;% length()))) { tmp = data.frame(stress = colnames(cpt_d_merge), fd = cpt_d_merge[i,] %&gt;% unlist()) tmp = tmp[order(tmp$fd),] if (classement %&gt;% is.null()){ classement = data.frame(gene = rep(gene[i], nb), stress = tmp$stress[1:nb], fd = tmp$fd[1:nb]) } else { classement = classement %&gt;% rbind(data.frame(gene = rep(gene[i], nb), stress = tmp$stress[1:nb], fd = tmp$fd[1:nb])) } } selection = classement$gene[classement$stress == &quot;camptothecin_500um&quot; &amp; classement$fd &lt; cutoff] write.table(selection, file = &quot;data/top_-genes.txt&quot;, quote = FALSE, row.names = FALSE) # Les moins sensibles gene2 = d_merge[d_merge$camptothecin_500um &gt; 0,]$Gene cpt_d_merge2 = d_merge[d_merge$camptothecin_500um &gt; 0,][-c(1,2)] classement = NULL nb = 15 cutoff = 1 for (i in c(1:(gene2 %&gt;% length()))) { tmp = data.frame(stress = colnames(cpt_d_merge2), fd = cpt_d_merge2[i,] %&gt;% unlist()) tmp = tmp[order(-tmp$fd),] if (classement %&gt;% is.null()){ classement = data.frame(gene = rep(gene2[i], nb), stress = tmp$stress[1:nb], fd = tmp$fd[1:nb]) } else { classement = classement %&gt;% rbind(data.frame(gene = rep(gene2[i], nb), stress = tmp$stress[1:nb], fd = tmp$fd[1:nb])) } } selection = classement$gene[classement$stress == &quot;camptothecin_500um&quot; &amp; classement$fd &gt; cutoff] write.table(selection, file = &quot;data/top_+genes.txt&quot;, quote = FALSE, row.names = FALSE) 4.3.1 GO enrichissement Ya rien qui marche bordel 4.3.2 Preuve que la première approche est fausse En selectionnant les mutant dont la medianne de fitness defect est la plus basse, on obtient le même enrichissement : med = data.frame(medianne = d_merge[-c(1,2)] %&gt;% apply(1, function(x){median(x)}), gene = d_merge$Gene) med = med[order(med$medianne),] week_mut = med$gene[1:40] write.table(week_mut, file = &quot;data/week_mut.txt&quot;, quote = FALSE, row.names = FALSE) tmp = read.table(&quot;data/go/preuve_function.txt&quot;, sep = &quot;\\t&quot;, header = TRUE) tmp = data.frame(Term = tmp$TERM, p_value = tmp$CORRECTED_PVALUE, FDR = tmp$FDR_RATE, Gene = tmp$ANNOTATED_GENES) knitr::kable(tmp, caption = &quot;Molecular Function&quot;) Table 4.2: Molecular Function Term p_value FDR Gene structural constituent of ribosome 0.0000000 0.00% RPS8A, RPS12, RPS0B, RPS21A, RPS29A, RPS2, RPL26B, RPL40A, RPS23B, RPS23A, RPL30, RPP1A, RPL22A, RPS24A, RPL5, RPL16B, RPS13, RPP1B, RPS21B, RPS29B, RPS6A, RPS3, RPL2B structural molecule activity 0.0000000 0.00% RPS12, RPS8A, RPS21A, NUP84, RPN9, NUP120, RPL40A, RPL30, RPP1A, RPS23B, RPS13, RPL5, RPS21B, RPS6A, RPS29B, RPS29A, RPS0B, RPS2, RPL26B, RPS23A, RPL22A, RPP1B, RPS24A, RPL16B, RPS3, RPL2B RNA binding 0.0000075 0.00% RRP4, NMD3, NOP58, MTR3, RRP9, RPL22A, RPL30, NOP56, SMD2, RPS2, RPL26B, CSL4, TIF6, RPS13, MRT4, RPL16B, RPL5, RPL2B, RPS3, NOP1 nucleic acid binding 0.0057705 3.50% RPS2, RPL26B, RPL30, NOP56, RPL22A, SMD2, NOP58, RRP9, MTR3, NMD3, RRP4, RPS3, NOP1, RPL2B, RPS13, MRT4, RPL5, RPL16B, CSL4, TIF6 rRNA binding 0.0071161 3.60% RPS2, RPL2B, RPL5, MRT4, RPS13, NMD3 4.4 Encore une autre approche Répartition de la médianne des fitness defect de chaque mutant med = d_merge[-c(1,2)] %&gt;% apply(MARGIN = 1, function(x){ median(x) }) ggplot(data.frame(medianne = med)) + aes(x = medianne)+ geom_density() seuil_min = -0.1 seuil_max = 0.2 d_merge_filtre = d_merge[med &gt; seuil_min &amp; med &lt; seuil_max,] cpt_filtre = data.frame(Gene = d_merge_filtre$Gene, Reponse_cpt = d_merge_filtre$camptothecin_500um) nb_gene = 50 top_x = cpt_filtre[order(cpt_filtre$Reponse_cpt),]$Gene[c(1:nb_gene)] write.table(top_x, file = &quot;data/top_x_gene.txt&quot;, quote = FALSE, row.names = FALSE) Rien d’enrichis non plus… Sauf si on prend un seuil baas plus petit que -0.3 auquel cas on retrouve ce foutu ribosome "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
