[["classif.html", "Chapter 5 Classification des stress 5.1 Classification via les données publiques : 5.2 Classification non supervisée : modèle de mélange", " Chapter 5 Classification des stress library(tidyr) library(stringr) library(FactoMineR) library(mclust) library(umap) library(ggplot2) library(ggrepel) u_merge = d_merge[-c(1,2)] %&gt;% t() %&gt;% as.data.frame() %&gt;% umap() 5.1 Classification via les données publiques : En utilisant les indication de (Hillenmeyer et al. 2008) sur les stress utilisés : tab = read.csv2(&quot;data/All_stress_annotated.csv&quot;, sep = &quot;\\t&quot;, header = TRUE) gg = data.frame(x = u_merge$layout[,1], y = u_merge$layout[,2], type = tab$Type, name = tab$x) ggplot(gg)+ aes(x = x, y = y, label = name)+ theme_classic()+ geom_label_repel(data = subset(gg, name == &quot;camptothecin_500um&quot;), nudge_y = 5 - subset(gg, name == &quot;camptothecin_500um&quot;)$y, size = 4, box.padding = 1.5, point.padding = 0, force = 100, segment.size = 0.2, segment.color = &quot;grey50&quot;) + geom_point(aes(color = type)) Et en regroupant certains stress entre eux : Antibacterien : antibacterial Antifungique : antifungal Cytotoxique : alkylating, antimetabolite, antineoplastic, cytoskeleton inhibitor Environment : vitamine dropout, temperature change Divers : anesthetic, anti-inflamatory, antihelminthic, antihistamine, antihypertensive, antimalarial, antiparkinson, diuretic, flavanoid, hormone, immunosuppressant, insecticide, ionic, laxative, lipid modifying, psychoactive, reagent, vitamin y = data.frame(type1 = tab$Type %&gt;% unique(), type2 = c(&quot;Cytotoxique&quot;, &quot;Inconnu&quot;, &quot;Autre&quot;, &quot;Environement&quot;, &quot;Chelateur&quot;, &quot;Antifongique&quot;, &quot;Cytotoxique&quot;, &quot;Divers&quot;, &quot;Antibactériens&quot;, &quot;Divers&quot;, &quot;Kinase inhibiteur&quot;, &quot;Divers&quot;, &quot;Antioxydant&quot;, &quot;Inhbiteur de la synthèse protéique&quot;, &quot;Inhibiteur de la synthèse d&#39;acide nucléique&quot;, &quot;Divers&quot;, &quot;Divers&quot;, &quot;Cytotoxique&quot;, &quot;Divers&quot;, &quot;Cytotoxique&quot;, &quot;Divers&quot;, &quot;Divers&quot;, &quot;Divers&quot;, &quot;Antiviral&quot;, &quot;Inhibiteur de phosphatase&quot;, &quot;Inhibiteur d&#39;enzyme&quot;, &quot;Divers&quot;,&quot;Divers&quot; , &quot;Divers&quot;, &quot;Divers&quot;, &quot;Divers&quot;, &quot;Divers&quot;, &quot;Stress Oxydant&quot;, &quot;Divers&quot;, &quot;Divers&quot;, &quot;Environement&quot;, &quot;Divers&quot;)) tab[[&quot;Type_merge&quot;]] = tab$Type %&gt;% sapply(function(s){ y$type2[y$type1 == s] }) %&gt;% unlist() gg[[&#39;type2&#39;]] = tab$Type_merge %&gt;% as.factor() ggplot(gg)+ aes(x = x, y = y, label = name)+ theme_classic()+ geom_label_repel(data = subset(gg, name == &quot;camptothecin_500um&quot;), nudge_y = 5 - subset(gg, name == &quot;camptothecin_500um&quot;)$y, size = 4, box.padding = 1.5, point.padding = 0, force = 100, segment.size = 0.2, segment.color = &quot;grey50&quot;) + geom_point(aes(color = type2)) 5.2 Classification non supervisée : modèle de mélange mc &lt;- Mclust(d_merge[-c(1,2)] %&gt;% t() %&gt;% as.data.frame(), G = seq(2,9)) # modèle de mélange avec choix automatique du modèle et du nombre de classe (entre 2 et 9) mc %&gt;% summary() ## ---------------------------------------------------- ## Gaussian finite mixture model fitted by EM algorithm ## ---------------------------------------------------- ## ## Mclust VEI (diagonal, equal shape) model with 7 components: ## ## log-likelihood n df BIC ICL ## -271553.7 448 34220 -752013.4 -752013.8 ## ## Clustering table: ## 1 2 3 4 5 6 7 ## 69 116 95 8 67 85 8 gg = data.frame(x = u_merge$layout[,1], y = u_merge$layout[,2], classe = mc$classification %&gt;% as.factor()) gg[[&#39;name&#39;]] = gg %&gt;% row.names() ggplot(gg)+ aes(x = x, y = y, label = name)+ theme_classic()+ geom_label_repel(data = subset(gg, name == &quot;camptothecin_500um&quot;), nudge_y = 6 - subset(gg, name == &quot;camptothecin_500um&quot;)$y, size = 4, box.padding = 1.5, point.padding = 0.5, force = 100, segment.size = 0.2, segment.color = &quot;grey50&quot;) + geom_point(aes(color = classe)) mc2 &lt;- Mclust(d_merge[-c(1,2)] %&gt;% t() %&gt;% as.data.frame(), G = seq(10,20)) # modèle de mélange avec choix automatique du modèle et du nombre de classe (entre 10 et 20) mc2 %&gt;% summary() ## ---------------------------------------------------- ## Gaussian finite mixture model fitted by EM algorithm ## ---------------------------------------------------- ## ## Mclust EEI (diagonal, equal volume and shape) model with 19 components: ## ## log-likelihood n df BIC ICL ## -207997.3 448 85538 -938186.3 -938186.3 ## ## Clustering table: ## 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 ## 32 85 47 17 1 41 2 1 9 4 21 57 38 44 1 1 1 39 7 gg = data.frame(x = u_merge$layout[,1], y = u_merge$layout[,2], classe = mc2$classification %&gt;% as.factor()) gg[[&#39;name&#39;]] = gg %&gt;% row.names() ggplot(gg)+ aes(x = x, y = y, label = name)+ theme_classic()+ geom_label_repel(data = subset(gg, name == &quot;camptothecin_500um&quot;), nudge_y = 6 - subset(gg, name == &quot;camptothecin_500um&quot;)$y, size = 4, box.padding = 1.5, point.padding = 0.5, force = 100, segment.size = 0.2, segment.color = &quot;grey50&quot;) + geom_point(aes(color = classe)) References "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
